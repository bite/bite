[DEFAULT]
	# command shortcuts
	s: search
	g: get
	a: attachments
	m: modify
	c: create
	at: attach

	# search for items assigned to the configured user
	me: search -a %{CONFIG:user}

	# meta alias takes a function as an argument and calls function for all other input
	loop: !loop() { for i in "${@:2}"; do $1 $i; done }; loop

	# iterate over whitespace-separated values passed as the second argument
	sloop: !sloop() { for i in $2; do $1 $i ${@:3}; done }; sloop

	# iterate over comma-separated values passed as the second argument
	cloop: !cloop() { for i in $(echo $2 | tr "," " "); do $1 $i ${@:3}; done }; cloop

# aliases for all bugzilla services
[:bugzilla:]
	# output list of bug dependencies by ID
	depends: !f() { bite -q search --id $1 --fields depends_on --output -; }; f
	# output list of bug blockers by ID
	blocks: !f() { bite -q search --id $1 --fields blocks --output -; }; f
	# output list of open bug dependencies
	show-depends: !
		f() {
			# get bug deps
			DEPENDS=( $(%{depends} $1) )
			# convert them into CSV
			DEPENDS=$(IFS=, ; echo "${DEPENDS[*]}")
			[[ -n ${DEPENDS} ]] && bite -q search --id ${DEPENDS} ${@:2}
		};
		%{cloop} f
	# output list of open bug blockers
	show-blocks: !
		f() {
			# get bug blockers
			BLOCKS=( $(%{blocks} $1) )
			# convert them into CSV
			BLOCKS=$(IFS=, ; echo "${BLOCKS[*]}")
			[[ -n ${BLOCKS} ]] && bite -q search --id ${BLOCKS} ${@:2}
		};
		%{cloop} f

# vim: set ft=sh:
